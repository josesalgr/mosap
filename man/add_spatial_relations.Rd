% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_spatial_relations.R
\name{add_spatial_relations}
\alias{add_spatial_relations}
\title{Add spatial relations (core)}
\usage{
add_spatial_relations(
  x,
  relations,
  name = "default",
  directed = FALSE,
  allow_self = FALSE,
  duplicate_agg = c("sum", "max", "min", "mean"),
  symmetric = FALSE
)
}
\arguments{
\item{x}{A \linkS4class{data} object created with \code{\link[=inputData]{inputData()}} or \code{\link[=inputDataSpatial]{inputDataSpatial()}}.}

\item{relations}{A \code{data.frame} describing edges. Must contain either:
\itemize{
\item \code{pu1}, \code{pu2}, \code{weight} (external PU ids), or
\item \code{internal_pu1}, \code{internal_pu2}, \code{weight} (internal indices).
}
Extra columns (e.g., \code{distance}, \code{source}) are allowed and preserved when possible.}

\item{name}{Character. Name/key under which to store the relation (default \code{"default"}).}

\item{directed}{Logical. If \code{FALSE} (default), treats edges as undirected and collapses duplicates.
If \code{TRUE}, keeps directed edges as provided.}

\item{allow_self}{Logical. Whether to allow self-edges \code{(i,i)}. Default \code{FALSE}.}

\item{duplicate_agg}{Aggregation for duplicate undirected edges when \code{directed=FALSE}.
One of \code{"sum"}, \code{"max"}, \code{"min"}, \code{"mean"}.}

\item{symmetric}{Logical. If \code{TRUE}, expands an undirected relation into a directed one by duplicating
off-diagonal edges in both directions. Default \code{FALSE}.}
}
\value{
Updated \linkS4class{data} object with \code{x$data$spatial_relations[[name]]}.
}
\description{
Register an externally computed spatial relation inside a \code{Data} object using the unified
internal representation. Most users should prefer the convenience wrappers:
\code{\link{add_spatial_boundary}}, \code{\link{add_spatial_rook}}, \code{\link{add_spatial_queen}},
\code{\link{add_spatial_knn}}, or \code{\link{add_spatial_distance}}.
}
\details{
The input can be given in external PU ids (\code{pu1}, \code{pu2}) or in internal PU indices
(\code{internal_pu1}, \code{internal_pu2}). If external ids are provided, they are mapped using
\code{x$data$pu$id} and \code{x$data$pu$internal_id}.

If \code{directed = FALSE}, edges are treated as undirected and duplicates are collapsed using
\code{duplicate_agg}. If \code{symmetric = TRUE}, the relation is expanded to a directed edge list
by adding swapped copies for off-diagonal edges.
}
\examples{
\dontrun{
# Register an externally computed adjacency list:
rel <- data.frame(pu1 = c(1, 1, 2), pu2 = c(2, 3, 3), weight = 1)
x <- x |> add_spatial_relations(relations = rel, name = "my_adj")
}

}
